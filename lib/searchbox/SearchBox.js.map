{"version":3,"names":[],"mappings":"","sources":["searchbox/SearchBox.js"],"sourcesContent":["/**\n * @file SearchBox\n * @author wuqi57(441984145@qq.com)\n * @time 17/6/6\n */\n\nimport {h, Component} from 'preact';\nimport classNames from 'classnames';\n\nimport Input from '../input/Input';\nimport Icon from '../icon/Icon';\nimport Button from '../button/Button';\nimport Suggestion from './Suggestion';\n\nimport {addClass, removeClass, closest} from '../util/dom';\n\n\nexport default class SearchBox extends Component {\n    static defaultProps = {\n        prefixCls: 'cui',\n        value: '',\n        placeholder: '搜索',\n        cancelBtnTxt: '取消',\n        searchIcon: (<Icon type=\"search\" size=\"14\" className=\"cui-searchbox-icon-search\" />),\n        deleteIcon: (<Icon type=\"round-close-fill\" size=\"14\" className=\"cui-searchbox-icon-delete\" />),\n        hasSug: true\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            value: props.value,\n            show: false\n        };\n\n        this.value = '';\n    }\n\n    /**\n     * 取消按钮\n     *\n     * @private\n     * @param {Event} e 事件对象\n     */\n    handleCancel(e) {\n        const {prefixCls, onCancel} = this.props;\n\n        let target = e.target;\n        let parent = target && closest(target, `.${prefixCls}-searchbox`);\n\n        parent && removeClass(parent, 'inputing');\n\n        this.setState({value: this.value, show: false});\n\n        onCancel && onCancel();\n    }\n\n    /**\n     * 清空按钮点击\n     *\n     * @private\n     */\n    handleDelete() {\n        const {hasSug, onGetSug, onInputChange} = this.props;\n\n        !hasSug && onInputChange && onInputChange('');\n        hasSug && this.state.show && onGetSug && onGetSug('');\n    }\n\n    /**\n     * 输入框input事件\n     *\n     * @private\n     * @param {Event} e 事件对象\n     */\n    handleChange(e) {\n        const {hasSug, onGetSug, onInputChange} = this.props;\n        let value = e.target.value;\n\n        this.setState({value});\n\n        !hasSug && onInputChange && onInputChange(value);\n        hasSug && this.state.show && onGetSug && onGetSug(value);\n    }\n\n    /**\n     * 输入框focus事件\n     *\n     * @private\n     * @param {Event} e 事件对象\n     */\n    handleFocus(e) {\n        const {prefixCls, hasSug, onInputFocus, onGetSug} = this.props;\n\n        let target = e.target;\n        let value = target.value;\n        let parent = target && closest(target, `.${prefixCls}-searchbox`);\n\n        parent && addClass(parent, 'inputing');\n        onInputFocus && onInputFocus(value);\n\n        this.setState({\n            show: true\n        });\n\n        hasSug && value && onGetSug && onGetSug(value);\n    }\n\n    /**\n     * 输入框软键盘按下事件\n     *\n     * @private\n     * @param {Event} e 事件对象\n     */\n    handleKeyDown(e) {\n        if (+e.keyCode === 13) {\n            e.preventDefault();\n            let value = e.target.value;\n            this.setState({show: false});\n\n            this.value = value;\n            this.props.onSearchSubmit && this.props.onSearchSubmit(value);\n        }\n    }\n\n    /**\n     * sug点击事件\n     *\n     * @public\n     * @param {string} value sug选择的query\n     */\n    sugClickHandle(value) {\n        this.setState({\n            value,\n            show: false\n        });\n\n        this.value = value;\n    }\n\n    render() {\n        const {\n            prefixCls,\n            className,\n            hasSug,\n            placeholder,\n            cancelBtnTxt,\n            searchIcon,\n            deleteIcon,\n            onRenderSugContent,\n            ...others\n        } = this.props;\n\n        const {show, value} = this.state;\n\n        const cls = classNames({\n            [`${prefixCls}-searchbox`]: true,\n            inputing: show,\n            [className]: className\n        });\n\n        return (\n            <div {...others} className={cls}>\n                <form className={`${prefixCls}-searchbox-wrap`}>\n                    <span className={`${prefixCls}-searchbox-i-search`}>\n                        {searchIcon}\n                    </span>\n                    <Input\n                        className={`${prefixCls}-searchbox-input`}\n                        type=\"search\"\n                        value={value}\n                        placeholder={placeholder}\n                        onInput={this.handleChange.bind(this)}\n                        onFocus={this.handleFocus.bind(this)}\n                        onKeyDown={this.handleKeyDown.bind(this)}\n                    />\n                    <span className={`${prefixCls}-searchbox-delete`} onClick={this.handleDelete.bind(this)}>\n                        {deleteIcon}\n                    </span>\n                    <Button\n                        type=\"default\"\n                        className={`${prefixCls}-searchbox-btn`}\n                        onClick={this.handleCancel.bind(this)}\n                    >\n                        {cancelBtnTxt}\n                    </Button>\n                </form>\n                {\n                    hasSug && (<Suggestion show={show}>\n                        {onRenderSugContent(this.sugClickHandle.bind(this))}\n                        </Suggestion>)\n                }\n            </div>\n        );\n    }\n}\n"],"file":"SearchBox.js"}