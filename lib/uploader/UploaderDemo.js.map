{"version":3,"names":[],"mappings":"","sources":["uploader/UploaderDemo.js"],"sourcesContent":["/**\n * @file Uplaoder demo\n * @author cgzero(cgzero@cgzero.com)\n * @data 2017-07-25\n */\n\n/* eslint-disable no-console */\nimport {h, Component} from 'preact';\nimport Uploader from './Uploader';\nimport {SingleImageView} from '../imageView/ImageView';\nimport imgCompress from '../util/imgCompress';\n\nexport default class InputDemo extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            files: [\n                {\n                    url: 'http://i2.kiimg.com/1949/f2c01dfe25649fd7t.jpg'\n                },\n                {\n                    url: 'http://i2.kiimg.com/1949/9458344e7e9986eat.jpg'\n                },\n                {\n                    url: 'http://i2.kiimg.com/1949/984ee020934108b7t.jpg'\n                },\n                {\n                    url: 'http://i2.kiimg.com/1949/984ee020934108b7t.jpg',\n                    error: true\n                },\n                {\n                    url: 'http://i2.kiimg.com/1949/984ee020934108b7t.jpg',\n                    status: '50%'\n                },\n                {\n                    url: 'http://i2.kiimg.com/1949/984ee020934108b7t.jpg',\n                    loading: true\n                }\n            ]\n        };\n    }\n\n    show(imagelist, current) {\n\n        // 用于大图展示的列表\n        let rawList = [];\n        for (let item of imagelist) {\n            rawList.push(item.url);\n        }\n\n        SingleImageView.show({\n            imagelist: rawList,\n            current: current,\n            showDeleteBtn: true,\n            enableRotate: true,\n            onDelete: idx => {\n                console.log(`删除了第${idx}张图片`);\n                SingleImageView.hide();\n\n                let newFiles = this.state.files;\n                newFiles.splice(idx, 1);\n                this.setState({\n                    files: newFiles\n                });\n            },\n            onHide() {\n                SingleImageView.hide();\n            }\n        });\n    }\n\n    render() {\n        return (\n            <div>\n                <Uploader\n                    files={this.state.files}\n                    maxCount={9}\n                    maxWidth={500}\n                    onError={msg => alert(msg)}\n                    onChange={file => {\n                        // 展示时取file的base64：file.data\n                        let newFiles = [...this.state.files, {url: file.data}];\n                        this.setState({\n                            files: newFiles\n                        });\n\n                        // 这里需要进行上传操作，可以调用图片压缩函数预先处理\n                        // 上传时取file的原始数据：file.nativeFile\n                        console.log('压缩前：', `${file.size}kb`);\n                        imgCompress({\n                            file: file.nativeFile,\n                            width: 500,\n                            callback(compressedFile) {\n                                console.log('压缩后：', `${compressedFile.size}kb`);\n\n                                // 这里可以进行上传ajax处理了\n                            }\n                        });\n                    }}\n                    onFileClick={\n                        (e, file, i) => {\n                            console.log('file click', file, i);\n                            // 预览图片\n                            this.show(this.state.files, i);\n\n                            // TODO 还可以扩展 imageView 加入图片旋转功能\n                        }\n                    }\n                    lang={{\n                        maxError(maxCount) {\n                            return `您上传的图片超出限制咯，最大上传${maxCount}张`;\n                        }\n                    }}\n                />\n            </div>\n        );\n    }\n}\n"],"file":"UploaderDemo.js"}